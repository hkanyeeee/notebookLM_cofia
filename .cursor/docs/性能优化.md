# 性能优化

目前在网页拉取、chunk是串行执行

网页内容拉取是串行的原因如下：

1. __后端API设计__：在`app/main.py`中的`/ingest`端点只接受单个URL，处理逻辑是串行的：


   \```python
   url = data.get("url")
   \# ... 验证URL
   text = await fetch_then_extract(url)  # 只处理一个URL
   \```

2. __前端处理逻辑__：在`notebookLM_front/src/components/Sidebar.vue`中，当用户添加多个URL时：


   \```typescript
   // 为每个URL调用store action（串行）
   for (const url of urls) {
     showAddDialog.value = false
     await store.addDocument(url);  // 串行处理每个URL
   }
   \```

3. __没有批量处理功能__：当前系统没有提供并行处理多个URL的功能。即使前端允许多个URL输入，后端仍然会逐个处理。



4. __单个URL处理流程__：对于单个URL，整个处理过程（获取内容→解析→分块→嵌入→向量数据库存储）都是串行执行的，这是由代码结构决定的。


如果要实现并行处理，需要：

\- 修改后端API支持批量URL处理
\- 前端同时发送多个请求或使用asyncio.gather进行并发处理
\- 在后端使用`asyncio.gather()`来并行处理多个URL的获取和处理

构建一个网页内容缓存池。

一个网页内容拉取完成后，存入缓存池。

缓存池的内容构成一个chunk队列，按队列顺序进行chunk、落库